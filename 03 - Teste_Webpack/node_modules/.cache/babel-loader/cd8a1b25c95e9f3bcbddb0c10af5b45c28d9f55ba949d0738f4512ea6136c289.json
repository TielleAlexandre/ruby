{"ast":null,"code":"var Test = require('tape/lib/test');\nfunction checkPromise(p) {\n  return p && p.then && typeof p.then === 'function';\n}\nTest.prototype.run = function () {\n  if (this._skip) return this.end();\n  this.emit('prerun');\n  try {\n    var p = this._cb && this._cb(this),\n      isPromise = checkPromise(p);\n    var self = this;\n    if (isPromise) p.then(function () {\n      self.end();\n    }, function (err) {\n      err ? self.error(err) : self.fail(err);\n      self.end();\n    });\n  } catch (err) {\n    err ? this.error(err) : this.fail(err);\n    this.end();\n    return;\n  }\n  this.emit('run');\n};\nmodule.exports = require('tape');","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}